<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Звезда Матрица</title>
  <style>
    body {
      background-color: #1c1c1c;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    .main-wrapper {
      max-width: 900px;
      margin: auto;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 10px;
    }
    .star-boxes {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }
    .star-block {
      background-color: #2a2a2a;
      border: 1px solid #00bfff;
      border-radius: 10px;
      padding: 15px;
      width: 160px;
      box-shadow: 0 0 10px #00bfff;
    }
    .star-block h3 {
      margin: 0 0 10px;
      color: #ffd700;
    }
    .sub-values {
      display: flex;
      justify-content: space-around;
      font-size: 14px;
    }
    svg {
      margin-top: 40px;
      background-color: #111;
      border: 1px solid #444;
      border-radius: 10px;
      padding: 10px;
    }
  </style>
</head>
<body>
  <div class="main-wrapper">
    <h1>Введите дату рождения</h1>
    <input type="date" id="birthdate" />
    <button onclick="calculateMatrix()">Показать звезды</button>

    <div class="star-boxes" id="matrix-container"></div>

    <h2>Символическая звезда</h2>
    <svg id="star-svg" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
      <polygon points="250,20 400,190 325,470 175,470 100,190" 
               fill="none" stroke="white" stroke-width="2" />
      <polygon points="250,150 330,200 300,300 200,300 170,200" 
               fill="none" stroke="white" stroke-width="1" />

      <text id="p1" x="245" y="15" font-size="16" fill="white">?</text>
      <text id="p2" x="410" y="190" font-size="16" fill="white">?</text>
      <text id="p3" x="340" y="480" font-size="16" fill="white">?</text>
      <text id="p4" x="140" y="480" font-size="16" fill="white">?</text>
      <text id="p5" x="70"  y="190" font-size="16" fill="white">?</text>
      <text id="pc" x="245" y="260" font-size="20" fill="white">?</text>
    </svg>
  </div>

  <script>
    function getDigits(dateStr) {
      return dateStr.replace(/-/g, '').split('').map(Number);
    }

    function sum(arr) {
      return arr.reduce((a, b) => a + b, 0);
    }

    function reduceTo22(n) {
      while (n > 22) {
        n = n.toString().split('').reduce((a, b) => a + Number(b), 0);
      }
      return n;
    }

    function calculateMatrix() {
      const input = document.getElementById("birthdate").value;
      const container = document.getElementById("matrix-container");
      const svgValues = ["p1", "p2", "p3", "p4", "p5", "pc"];

      container.innerHTML = "";

      if (!input) {
        alert("Введите дату рождения");
        return;
      }

      const digits = getDigits(input);
      const values = [];

      for (let i = 0; i < 12; i++) {
        const a = sum([...digits, i]);
        const b = reduceTo22(a);
        const c = reduceTo22(a + b);
        const d = reduceTo22(b + c);
        values.push({ name: `Сфера ${i + 1}`, all: [a, b, c, d] });
      }

      values.forEach((star, idx) => {
        const box = document.createElement("div");
        box.className = "star-block";

        const title = document.createElement("h3");
        title.textContent = star.name;
        box.appendChild(title);

        const sub = document.createElement("div");
        sub.className = "sub-values";
        star.all.forEach(v => {
          const span = document.createElement("span");
          span.textContent = v;
          sub.appendChild(span);
        });

        box.appendChild(sub);
        container.appendChild(box);

        if (idx < svgValues.length) {
          document.getElementById(svgValues[idx]).textContent = star.all[1];
        }
      });
    }
  </script>
</body>
</html>